exec_module({name:"House timers",desc:"Shows house construction timers without the need for an alarm clock",dependencies:{fn:["parseTimeStringLong"],classes:["AloTimer","CssManager","Interval"]},load:function(e,d){var b=e("<div class='col-xs-6 col-md-12'/>");function c(){e.post("/house.php")}function a(g){g.clear();d.vars.paneSpan.addClass("avi-highlight").html(e('<span data-delegate-click="#header_house" style="cursor:pointer;text-decoration:underline;padding-right:5px">Ready!</span>')).append(e("<a href='javascript:;'>(refresh)</a>").click(c))}function f(h){var g=new d.dependencies.classes.Interval(d.spec.name);g.clear();if(h.indexOf("available again")!==-1){var i=new d.dependencies.classes.AloTimer(d.dependencies.fn.parseTimeStringLong(h));g.set(function(){if(i.isFinished()){a(g)}else{d.vars.paneSpan.removeClass("avi-highlight").text(i.toString())}},1000)}else{if(h.indexOf("are available")!==-1){a(g)}else{setTimeout(c,3000)}}}d.vars={paneLabel:b.clone().addClass("col-lg-5 gold").text("Construction:"),paneSpan:e("<span>House unavailable</span>"),house_requery:function(g,i,h){if(h.url.indexOf("house")!==-1&&typeof(i.responseJSON)!=="undefined"&&typeof(i.responseJSON.m)!=="undefined"){f(i.responseJSON.m)}},css:(new d.dependencies.classes.CssManager()).setRules({"#constructionNotifier,#houseTimerTable [data-typeid='Construction']":{display:"none !important"}}).addToDOM()};d.vars.paneSpanContainer=b.clone().addClass("col-lg-7").html(d.vars.paneSpan);e("#houseTimerInfo").addClass("avi-force-block");e("#houseTimerTable").prepend(d.vars.paneLabel,d.vars.paneSpanContainer);e(document).ajaxComplete(d.vars.house_requery);e.ajax("/house.php",{global:false}).done(function(g){if(typeof(g.m)!=="undefined"){f(g.m)}})},unload:function(b,a){a.vars.paneLabel.remove();a.vars.paneSpanContainer.remove();a.vars.css.removeFromDOM();b(document).unbind("ajaxComplete",a.vars.house_requery);b("#houseTimerInfo").removeClass("avi-force-block");(new a.dependencies.classes.Interval(a.spec.name)).clear()}});